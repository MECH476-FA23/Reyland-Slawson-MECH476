method = "lm",
formula = "y ~ x",
color = "black")
bodysize_blof
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
model1_coef <- coefficients(model1)
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
model2_coef <- coefficients(model2)
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_coef <- coefficients(model3)
model1_coef
model2_coef
model3_coef
model3_coef <- summary(coefficients(model3))
movel3_coef
model3_coef <- summary(coefficients(model3))
model3_coef
model3_sum <- summary(model3)
model3_c <- model3_sum[["coefficients"]]
model3_c
summary(model3[["coefficients""]])
summary(model3[["coefficients"]])
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary(coefficients(model3))
coef_m3 <- model13_sum[["coeffcients"]]
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary(coefficients(model3))
coef_m3 <- model3_sum[["coeffcients"]]
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary(coefficients(model3))
coef_m3 <- model3_sum[["coefficients"]]
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary((model3)
coef_m3 <- model3_sum[["coefficients"]]
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary(model3)
coef_m3 <- model3_sum[["coefficients"]]
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
model1_sum <- summary(model1)
coef_m1 <- model1_sum[["coefficients"]]
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
model2_sum <- summary(model2)
coef_m2 <- model2_sum[["coefficients"]]
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
model3_sum <- summary(model3)
coef_m3 <- model3_sum[["coefficients"]]
coef_m1
coef_m2
coef_m3
bodysize_1 <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
View(bodysize_1)
View(bodysize_blof)
View(bodysize_data)
View(bodysize_blof)
View(bodysize_data)
View(bodysize_1)
View(bodysize_data)
View(bodysize_1)
bodysize_1 <- bodysize_data %>%
dplyr::mutate(volume = (waist^2)*height)
bodysize_1 <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
model1$coefficients
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
coef_m1 <- coefficients(model1)
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
coef_m3 <- coefficients(model2)
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
coef_m3 <- coefficients(model3)
coef_m1
coef_m2
coef_m3
# set global options for figures, code, warnings, and messages
knitr::opts_chunk$set(fig.width=6, fig.height=4, fig.path="../figs/",
echo=TRUE, warning=FALSE, message=FALSE)
# load packages for current session
library(tidyverse)
library(gridExtra)
bodysize_csv <- "/Users/genevieve/Reyland-MECH476/data/bodysize.csv"
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
coef_m1 <- coefficients(model1)
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
coef_m3 <- coefficients(model2)
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
coef_m3 <- coefficients(model3)
coef_m1
coef_m2
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
coef_m1 <- coefficients(model1)
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
coef_m2 <- coefficients(model2)
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
coef_m3 <- coefficients(model3)
coef_m1
coef_m2
coef_m3
bodysize_1 <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
model4 <- lm(mass ~ volume,
data = bodysize_data)
bodysize_1 <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
model4 <- lm(mass ~ volume,
data = bodysize_data)
bodysize_data <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
model4 <- lm(mass ~ volume,
data = bodysize_data)
summary(model4)
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
color = "navy") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula "y ~ x",
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
color = "navy") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula = "y ~ x",
color = "black") +
labs(x = "Volume (cm^3)",
y = "Mass (kg)",
title = "Volume vs Mass") +
theme_bw()
q2b_plot
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
color = "lightblue") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula = "y ~ x",
color = "black") +
labs(x = "Volume (cm^3)",
y = "Mass (kg)",
title = "Volume vs Mass") +
theme_bw()
q2b_plot
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(data = caload_csv)
calaod_data <- readr::read_csv(data = caload_csv)
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(data = caload_csv)
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(data = caload_csv)
calaod_data <- readr::read_csv(file = caload_csv)
View(calaod_data)
# load data
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = amod ~ aeronet,
data = caload_data)
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = amod ~ aeronet,
data = caload_data)
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
calaod_data <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = amod ~ aeronet,
data = caload_data)
calaod_data <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = amod ~ aeronet,
data = caload_data)
calaod_data <- readr::read_csv(file = caload_csv)
View(calaod_data)
caload_model <- lm(formula = amod ~ aeronet,
data = caload_data)
cal_oad <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = armod ~ aeronet,
data = cal_aod)
# load data
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
# set global options for figures, code, warnings, and messages
knitr::opts_chunk$set(fig.width=6, fig.height=4, fig.path="../figs/",
echo=TRUE, warning=FALSE, message=FALSE)
# load packages for current session
library(tidyverse)
library(gridExtra)
bodysize_csv <- "/Users/genevieve/Reyland-MECH476/data/bodysize.csv"
bodysize_data <- readr::read_csv(file = bodysize_csv)
model1 <- lm(formula = height ~ waist,
data = bodysize_data)
coef_m1 <- coefficients(model1)
model2 <- lm(formula = height ~ mass,
data = bodysize_data)
coef_m2 <- coefficients(model2)
model3 <- lm(formula = height ~ waist + mass,
data = bodysize_data)
coef_m3 <- coefficients(model3)
coef_m1
coef_m2
coef_m3
bodysize_data <- bodysize_data %>%
dplyr::mutate(volume = waist^2 * height)
model4 <- lm(mass ~ volume,
data = bodysize_data)
summary(model4)
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
color = "lightblue") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula = "y ~ x",
color = "black") +
labs(x = "Volume (cm^3)",
y = "Mass (kg)",
title = "Volume vs Mass") +
theme_bw()
q2b_plot
# load data
caload_csv <- "/Users/genevieve/Reyland-MECH476/data/cal_aod.csv"
cal_aod <- readr::read_csv(file = caload_csv)
caload_model <- lm(formula = amod ~ aeronet,
data = cal_aod)
#assumption 4: mean of residuals is zero
caload_mean <- mean(caload_model$residuals)
caload_mean
q3b_model <- ggplot(data = caload_model$model,
aes(sample = caload_model$residuals)) +
geom_qq(alpha = 0.3,
color = "pink") +
geom_qq_line(color = "black") +
scale_y_continuous(limits(-0.1, 0.2)) +
labs(title = "Mass vs Waist") +
theme_bw()
q3b_model <- ggplot(data = caload_model$model,
aes(sample = caload_model$residuals)) +
geom_qq(alpha = 0.3,
color = "pink") +
geom_qq_line(color = "black") +
scale_y_continuous(limits = c(-0.1, 0.2)) +
labs(title = "Mass vs Waist") +
theme_bw()
q3b_model
q3b_model <- ggplot(data = caload_model$model,
aes(sample = caload_model$residuals)) +
geom_qq(alpha = 0.3,
color = "maroon") +
geom_qq_line(color = "black") +
scale_y_continuous(limits = c(-0.1, 0.2)) +
labs(title = "Mass vs Waist") +
theme_bw()
q3b_model
q3b_model <- ggplot(data = caload_model$model,
aes(sample = caload_model$residuals)) +
geom_qq(alpha = 0.5,
color = "maroon") +
geom_qq_line(color = "black") +
scale_y_continuous(limits = c(-0.1, 0.2)) +
labs(title = "Mass vs Waist") +
theme_bw()
q3b_model
q3c <- ggplot(data = caload_model$model) +
geom_point(aes(x = caload_model$fitted.values,
y = caload_model$residuals),
alpha = 0.3,
color = "skyblue") +
geom_hline*yintercept = 0) +
q3c <- ggplot(data = caload_model$model) +
geom_point(aes(x = caload_model$fitted.values,
y = caload_model$residuals),
alpha = 0.3,
color = "skyblue") +
geom_hline(yintercept = 0) +
labs(x = "Residuals",
y = "Fitted Values",
title = "Mass vs Weight") +
theme_bw()
q3c
```{r ch11-homework-q3b}
q3b_model <- ggplot(data = caload_model$model,
aes(sample = caload_model$residuals)) +
geom_qq(alpha = 0.8,
color = "maroon") +
geom_qq_line(color = "black") +
scale_y_continuous(limits = c(-0.1, 0.2)) +
labs(title = "Mass vs Waist") +
theme_bw()
q3b_model
q3c <- ggplot(data = caload_model$model) +
geom_point(aes(x = caload_model$fitted.values,
y = caload_model$residuals),
alpha = 0.8,
color = "skyblue") +
geom_hline(yintercept = 0) +
labs(x = "Residuals",
y = "Fitted Values",
title = "Mass vs Weight") +
theme_bw()
q3c
q3d <- cor(x = cal_model$residuals,
y = cal_model$model[,2],
method = "peason")
q3d <- cor(x = cal_model$residuals,
y = cal_model$model[,2],
method = "pearson")
q3d <- cor(x = cal_model$residuals,
y = cal_model$model[,2],
method = "pearson")
q3d <- cor(x = caload_model$residuals,
y = caload_model$model[,2],
method = "pearson")
q3d
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
fill = "lightblue") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula = "y ~ x",
color = "black") +
labs(x = "Volume (cm^3)",
y = "Mass (kg)",
title = "Volume vs Mass") +
theme_bw()
q2b_plot
q2b_plot <- ggplot(data = bodysize_data) +
geom_point(aes(x = volume,
y = mass),
alpha = 0.3,
color = "lightblue") +
geom_smooth(aes(x = volume,
y = mass),
method = "lm",
formula = "y ~ x",
color = "black") +
labs(x = "Volume (cm^3)",
y = "Mass (kg)",
title = "Volume vs Mass") +
theme_bw()
q2b_plot
model1 <- lm(mass ~ waist,
data = data_18)
# set global options for figures, code, warnings, and messages
knitr::opts_chunk$set(fig.width = 6, fig.height = 4, fig.path = "../figs/",
echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(ggplot2)
body_csv <- "/Users/genevieve/Reyland-MECH476/data/bodysize.csv"
body_data <- readr::read_csv(file = body_csv)
ggplot(data = body_data) +
geom_point(aes(x = waist,
y = mass),
alpha = 0.3)
p1 <- ggplot(data = body_data) +
geom_point(aes(x = waist, y = mass),
alpha = 0.1,
color = "maroon4") +
ylab("Mass, kg") +
xlab("Waist Circumference, cm") +
theme_classic(base_size = 13)
p2 <- ggplot(data = body_data) +
geom_point(aes(x = waist, y = sqrt_mass),
alpha = 0.1,
color = "royalblue2") +
ylab(expression(sqrt(mass))) +
xlab("Waist Circumference, cm") +
theme_classic(base_size = 13)
grid.arrange(p1, p2, ncol = 2)
model1 <- lm(mass ~ waist,
data = data_18)
model1 <- lm(mass ~ waist,
data = body_data)
model1 <- lm(mass ~ waist,
data = body_data)
model2 <- lm(sqrt_mass ~ waist,
data = body_data)
summary(model1)
```
summary(model1)
mean(model1$residuals)
mean(model2$residuals)
p3 <- ggplot(data  = model1$model, aes(sample = model1$residuals)) +
geom_qq(alpha = 0.1,
color = "maroon4") +
geom_qq_line(color = "grey") +
ggtitle("Model 1: mass ~ waist") +
theme_classic()
p4 <- ggplot(data  = model2$model, aes(sample = model2$residuals)) +
geom_qq(alpha = 0.1,
color = "royalblue2") +
geom_qq_line(color = "grey") +
ggtitle("Model 2: sqrt(mass) ~ waist") +
theme_classic()
grid.arrange(p3, p4, ncol = 2)
library(tidyverse)
library(ggplot2)
library(gridExtra)
mean(model1$residuals)
mean(model2$residuals)
p3 <- ggplot(data  = model1$model, aes(sample = model1$residuals)) +
geom_qq(alpha = 0.1,
color = "maroon4") +
geom_qq_line(color = "grey") +
ggtitle("Model 1: mass ~ waist") +
theme_classic()
p4 <- ggplot(data  = model2$model, aes(sample = model2$residuals)) +
geom_qq(alpha = 0.1,
color = "royalblue2") +
geom_qq_line(color = "grey") +
ggtitle("Model 2: sqrt(mass) ~ waist") +
theme_classic()
grid.arrange(p3, p4, ncol = 2)
# line is expected to be perfect, so the points should be on the line to be evenly distributed. The graphs show the expected over a normal distribution
mean(model1$residuals)
mean(model2$residuals)
## Q-Q Plot to check for Assumption 5: the error term is normall distributed
p3 <- ggplot(data  = model1$model, aes(sample = model1$residuals)) +
geom_qq(alpha = 0.1,
color = "maroon4") +
geom_qq_line(color = "grey") +
ggtitle("Model 1: mass ~ waist") +
theme_classic()
p4 <- ggplot(data  = model2$model, aes(sample = model2$residuals)) +
geom_qq(alpha = 0.1,
color = "royalblue2") +
geom_qq_line(color = "grey") +
ggtitle("Model 2: sqrt(mass) ~ waist") +
theme_classic()
grid.arrange(p3, p4, ncol = 2)
# line is expected to be perfect, so the points should be on the line to be evenly distributed. The graphs show the expected over a normal distribution
## checking assumption 6: the error term is homoscedastic
p5 <- ggplot(data = model1$model) +
geom_point(aes(x = model1$fitted.values, y =model1$residuals),
alpha = 0.25,
color = "maroon3") +
geom_hline(yintercept = 0) +
theme_classic() +
theme(aspect.ratio = 0.5)
p6 <- ggplot(data = model2$model)+
geom_point(aes(x = model2$fitted.values, y =model2$residuals),
alpha = 0.25,
color= "royalblue2") +
geom_hline(yintercept = 0) +
theme_classic() +
theme(aspect.ratio = 0.5)
grid.arrange(p5, p6, ncol = 1)
# checking assumption 7: no autocorrelation among residuals
stats:pacf(model$residuals,
main = "Model 1 Partial Autocorrelation Plot")
# checking assumption 7: no autocorrelation among residuals
stats::pacf(model$residuals,
main = "Model 1 Partial Autocorrelation Plot")
# checking assumption 7: no autocorrelation among residuals
stats::pacf(model1$residuals,
main = "Model 1 Partial Autocorrelation Plot")
#checking assumption 8: residuals are not correlated with predictor variables
cor(x = model1$residuals,
y = model1$model[,2],
method = "pearson" )
cor(x = model2$residuals,
y = model1$model[,2],
method = "pearson" )
body_csv <- "/Users/genevieve/Reyland-MECH476/data/bodysize.csv"
body_data <- readr::read_csv(file = body_csv) %>%
mutate(sex = gender - 1)
ggplot(data = body_data) +
geom_point(aes(x = waist,
y = mass),
alpha = 0.3)
model3 <- lm(mass ~ waist + gender, data = body_data)
sumary(model3)
model3 <- lm(mass ~ waist + gender, data = body_data)
summary(model3)
View(model1)
View(body_data)
model3 <- lm(mass ~ waist + gender, data = body_data)
summary(model3)
# specify model more
model4 <- lm(mass ~ height*waist^2 + gender + age, data = body_data)
summary(model4)
